'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();Object.defineProperty(exports,'__esModule',{value:!0});function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var MicroRouter=function(){function a(b){var c=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];_classCallCheck(this,a),this.key=b||'state_view_router_state',this.routes=[],this.callbacks=[],this.defaultRoute=null,this.persistStateToLocalstorage=c}return _createClass(a,[{key:'addRoute',value:function addRoute(a,b){this.routes.push({route:a,view:b})}},{key:'setDefaultRoute',value:function setDefaultRoute(a){this.defaultRoute=a}},{key:'currentState',value:function currentState(){return this.resolve(localStorage.getItem(this.key)||this.defaultRoute)}},{key:'currentWindowHashState',value:function currentWindowHashState(){return this.resolve(window.location.hash.replace('#',''))}},{key:'bindToWindowHash',value:function bindToWindowHash(){window.onhashchange=function(){this.navigate(this.currentWindowHashState())}}},{key:'resolve',value:function resolve(a){for(var b,c=a.split('/'),d=0;d<this.routes.length;d++)if(b=this.routes[d].route.split('/'),b.length===c.length){for(var e={view:this.routes[d].view},f=!0,g=0;g<b.length;g++){var h=c[g],i=b[g];if(':'===i[0])e[i.replace(':','')]=h;else if(i!==h){f=!1;break}}if(f)return e}return this.resolve(this.defaultRoute)}},{key:'navigate',value:function navigate(a){var b=this.buildPath(a);this.persistStateToLocalstorage&&localStorage.setItem(this.key,b),this.runCallbacks()}},{key:'navigateByPath',value:function navigateByPath(a){var b=this.resolve(a);this.navigate(b)}},{key:'afterNavigate',value:function afterNavigate(a){this.callbacks.push(a)}},{key:'runCallbacks',value:function runCallbacks(){this.callbacks.forEach(function(a){a()})}},{key:'buildPath',value:function buildPath(a){for(var b=this.routeForView(a.view),c=b.route,d=c.split('/'),e=d.filter(function(a){return':'===a[0]}).map(function(a){return a.slice(1)}),f=0;f<e.length;f++)c=c.replace(':'+e[f],a[e[f]]);return c}},{key:'routeForView',value:function routeForView(a){for(var b=0;b<this.routes.length;b++)if(this.routes[b].view===a)return this.routes[b]}}]),a}();exports.default=MicroRouter;module.exports=exports['default'];